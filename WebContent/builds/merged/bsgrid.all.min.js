/**
* jQuery.bsgrid v1.30 by @Baishui2004
* Copyright 2014 Apache v2 License
* https://github.com/baishui2004/jquery.bsgrid
*/

String.prototype.startWith=function(a){if(a==null||a==""||this.length==0||a.length>this.length){return false}return this.substr(0,a.length)==a};String.prototype.endWith=function(a){if(a==null||a==""||this.length==0||a.length>this.length){return false}return this.substring(this.length-a.length)==a};String.prototype.replaceAll=function(a,b){return this.replace(new RegExp(a,"gm"),b)};function StringBuilder(){if(arguments.length){this.append.apply(this,arguments)}}StringBuilder.prototype=function(){var c=Array.prototype.join,d=Array.prototype.slice,a=/\{(\d+)\}/g,b=function(){return c.call(this,"")};return{constructor:StringBuilder,length:0,append:Array.prototype.push,appendFormat:function(e){var g=0,f=d.call(arguments,1);this.append(a.test(e)?e.replace(a,function(h,j){return f[j]}):e.replace(/\?/g,function(){return f[g++]}));return this},size:function(){return this.toString().length},toString:b,valueOf:b}}();
$.bsgrid={param:function(c,b){if(b==undefined){b=false}if(!b){return $.param(c)}var d=new StringBuilder();if(c instanceof Array){$.each(c,function(f,e){d.append("&"+e.name+"=");d.append(encodeURIComponent(encodeURIComponent(e.value)))})}else{for(var a in c){d.append("&"+a+"=");d.append(encodeURIComponent(encodeURIComponent(c[a])))}}return d.length>0?d.toString().substring(1):""},getKeysString:function(c,a){if(a==undefined){a=","}var d=new StringBuilder();if(c instanceof Array){$.each(c,function(f,e){if((d.toString()+a).indexOf(a+e.name+a)==-1){d.append(a+e.name)}})}else{for(var b in c){d.append(a+b)}}return d.length>0?d.toString().substring(1):""}};
(function(a){a.fn.bsgrid_paging={defaults:{loopback:false,pageSize:20,pageSizeSelect:false,pageSizeForGrid:[5,10,20,25,50,100,200,500],pagingBtnClass:"pagingBtn"},pagingObjs:{},init:function(h,g){var d={settings:a.extend(true,{},a.fn.bsgrid_paging.defaults,g),pagingId:h,totalRowsId:h+"_totalRows",totalPagesId:h+"_totalPages",curPageId:h+"_curPage",gotoPageInputId:h+"_gotoPageInput",gotoPageId:h+"_gotoPage",pageSizeId:h+"_pageSize",firstPageId:h+"_firstPage",prevPageId:h+"_prevPage",nextPageId:h+"_nextPage",lastPageId:h+"_lastPage",startRowId:h+"_startRow",endRowId:h+"_endRow",totalRows:0,totalPages:0,curPage:1,curPageRowsNum:0,startRow:0,endRow:0};var b={options:d,page:function(i){a.fn.bsgrid_paging.page(i,d)},getCurPage:function(){return a.fn.bsgrid_paging.getCurPage(d)},refreshPage:function(){a.fn.bsgrid_paging.refreshPage(d)},firstPage:function(){a.fn.bsgrid_paging.firstPage(d)},prevPage:function(){a.fn.bsgrid_paging.prevPage(d)},nextPage:function(){a.fn.bsgrid_paging.nextPage(d)},lastPage:function(){a.fn.bsgrid_paging.lastPage(d)},gotoPage:function(i){a.fn.bsgrid_paging.gotoPage(d,i)},createPagingToolbar:function(){return a.fn.bsgrid_paging.createPagingToolbar(d)},setPagingToolbarEvents:function(){a.fn.bsgrid_paging.setPagingToolbarEvents(d)},dynamicChangePagingButtonStyle:function(){a.fn.bsgrid_paging.dynamicChangePagingButtonStyle(d)},setPagingValues:function(j,i){a.fn.bsgrid_paging.setPagingValues(j,i,d)}};a.fn.bsgrid_paging.pagingObjs[h]=b;a("#"+h).append(b.createPagingToolbar());if(d.settings.pageSizeSelect){if(a.inArray(d.settings.pageSize,d.settings.pageSizeForGrid)==-1){d.settings.pageSizeForGrid.push(d.settings.pageSize)}d.settings.pageSizeForGrid.sort(function(j,i){return j-i});var f=new StringBuilder();for(var e=0;e<d.settings.pageSizeForGrid.length;e++){var c=d.settings.pageSizeForGrid[e];f.append('<option value="'+c+'">'+c+"</option>")}a("#"+d.pageSizeId).html(f.toString()).val(d.settings.pageSize)}b.setPagingToolbarEvents();return b},getPagingObj:function(c){var b=a.fn.bsgrid_paging.pagingObjs[c];return b?b:null},page:function(c,b){var d=a.fn.bsgrid.getGridObj(b.settings.gridId);d.options.settings.pageSize=b.settings.pageSize;a.fn.bsgrid.page(c,d.options)},getCurPage:function(b){var c=a("#"+b.curPageId).html();return c==""?1:c},refreshPage:function(b){a.fn.bsgrid_paging.page(a.fn.bsgrid_paging.getCurPage(b),b)},firstPage:function(b){var c=a.fn.bsgrid_paging.getCurPage(b);if(c<=1){alert(a.bsgridLanguage.isFirstPage);return}a.fn.bsgrid_paging.page(1,b)},prevPage:function(b){var c=a.fn.bsgrid_paging.getCurPage(b);if(c<=1){if(b.settings.loopback&&b.totalPages>0){a.fn.bsgrid_paging.page(b.totalPages,b);return}else{alert(a.bsgridLanguage.isFirstPage);return}}a.fn.bsgrid_paging.page(parseInt(c)-1,b)},nextPage:function(b){var c=a.fn.bsgrid_paging.getCurPage(b);if(c>=b.totalPages){if(b.settings.loopback&&c>0){a.fn.bsgrid_paging.page(1,b);return}else{alert(a.bsgridLanguage.isLastPage);return}}a.fn.bsgrid_paging.page(parseInt(c)+1,b)},lastPage:function(b){var c=a.fn.bsgrid_paging.getCurPage(b);if(c>=b.totalPages){alert(a.bsgridLanguage.isLastPage);return}a.fn.bsgrid_paging.page(b.totalPages,b)},gotoPage:function(b,c){if(c==undefined){c=a("#"+b.gotoPageInputId).val()}if(a.trim(c)==""||isNaN(c)){alert(a.bsgridLanguage.needInteger)}else{if(parseInt(c)<1||parseInt(c)>b.totalPages){alert(a.bsgridLanguage.needRange(1,b.totalPages))}else{a("#"+b.gotoPageInputId).val(c);a.fn.bsgrid_paging.page(parseInt(c),b)}}},createPagingToolbar:function(b){var d=new StringBuilder();d.append('<table class="bsgridPaging'+(b.settings.pageSizeSelect?"":" noPageSizeSelect")+'">');d.append("<tr>");if(b.settings.pageSizeSelect){d.append("<td>"+a.bsgridLanguage.pagingToolbar.pageSizeDisplay(b.pageSizeId)+"</td>")}d.append("<td>"+a.bsgridLanguage.pagingToolbar.currentDisplayRows(b.startRowId,b.endRowId)+"</td>");d.append("<td>"+a.bsgridLanguage.pagingToolbar.totalRows(b.totalRowsId)+"</td>");var c=b.settings.pagingBtnClass;d.append("<td>");d.append('<input class="'+c+' firstPage" type="button" id="'+b.firstPageId+'" value="'+a.bsgridLanguage.pagingToolbar.firstPage+'" />');d.append("&nbsp;&nbsp;");d.append('<input class="'+c+' prevPage" type="button" id="'+b.prevPageId+'" value="'+a.bsgridLanguage.pagingToolbar.prevPage+'" />');d.append("</td>");d.append("<td>"+a.bsgridLanguage.pagingToolbar.currentDisplayPageAndTotalPages(b.curPageId,b.totalPagesId)+"</td>");d.append("<td>");d.append('<input class="'+c+' nextPage" type="button" id="'+b.nextPageId+'" value="'+a.bsgridLanguage.pagingToolbar.nextPage+'" />');d.append("&nbsp;&nbsp;");d.append('<input class="'+c+' lastPage" type="button" id="'+b.lastPageId+'" value="'+a.bsgridLanguage.pagingToolbar.lastPage+'" />');d.append("</td>");d.append("<td>");d.append('<input class="gotoPageInput" type="text" id="'+b.gotoPageInputId+'" />');d.append("&nbsp;");d.append('<input class="'+c+' gotoPage" type="button" id="'+b.gotoPageId+'" value="'+a.bsgridLanguage.pagingToolbar.gotoPage+'" />');d.append("</td>");d.append("</tr>");d.append("</table>");return d.toString()},setPagingToolbarEvents:function(b){if(b.settings.pageSizeSelect){a("#"+b.pageSizeId).change(function(){b.settings.pageSize=parseInt(a(this).val());a(this).trigger("blur");a.fn.bsgrid_paging.page(1,b)})}a("#"+b.firstPageId).click(function(){a.fn.bsgrid_paging.firstPage(b)});a("#"+b.prevPageId).click(function(){a.fn.bsgrid_paging.prevPage(b)});a("#"+b.nextPageId).click(function(){a.fn.bsgrid_paging.nextPage(b)});a("#"+b.lastPageId).click(function(){a.fn.bsgrid_paging.lastPage(b)});a("#"+b.gotoPageInputId).keyup(function(c){if(c.which==13){a.fn.bsgrid_paging.gotoPage(b)}});a("#"+b.gotoPageId).click(function(){a.fn.bsgrid_paging.gotoPage(b)})},dynamicChangePagingButtonStyle:function(b){var c="disabledCls";if(b.curPage<=1){a("#"+b.firstPageId).addClass(c);a("#"+b.prevPageId).addClass(c)}else{a("#"+b.firstPageId).removeClass(c);a("#"+b.prevPageId).removeClass(c)}if(b.curPage>=b.totalPages){a("#"+b.nextPageId).addClass(c);a("#"+b.lastPageId).addClass(c)}else{a("#"+b.nextPageId).removeClass(c);a("#"+b.lastPageId).removeClass(c)}},setPagingValues:function(i,g,f){var b=f.settings.pageSize;var h=parseInt(g/b);h=parseInt((g%b==0)?h:h+1);var e=(i*b<g)?b:(g-(i-1)*b);var d=(i-1)*b+1;var c=(i-1)*b+e;d=e<=0?0:d;c=e<=0?0:c;f.totalRows=g;f.totalPages=h;f.curPage=i;f.curPageRowsNum=e;f.startRow=d;f.endRow=c;a("#"+f.totalRowsId).html(f.totalRows);a("#"+f.totalPagesId).html(f.totalPages);a("#"+f.curPageId).html(f.curPage);a("#"+f.startRowId).html(f.startRow);a("#"+f.endRowId).html(f.endRow);a.fn.bsgrid_paging.dynamicChangePagingButtonStyle(f)}}})(jQuery);
(function($){$.fn.bsgrid={defaults:{url:"",dataType:"json",autoLoad:true,pageAll:false,pageSize:20,pageSizeSelect:false,pageSizeForGrid:[5,10,20,25,50,100,200,500],displayBlankRows:true,stripeRows:false,pagingToolbarAlign:"right",pagingBtnClass:"pagingBtn",displayPagingToolbarOnlyMultiPages:false,isProcessLockScreen:true,longLengthAotoSubAndTip:true,colsProperties:{align:"center",maxLength:40,indexAttr:"w_index",sortAttr:"w_sort",alignAttr:"w_align",lengthAttr:"w_length",renderAttr:"w_render",hiddenAttr:"w_hidden",tipAttr:"w_tip"},requestParamsName:{pageSize:"pageSize",curPage:"curPage",sortName:"sortName",sortOrder:"sortOrder"},beforeSend:function(options,XMLHttpRequest){},complete:function(options,XMLHttpRequest,textStatus){},extend:{initGridMethods:{},beforeRenderGridMethods:{},renderPerRowMethods:{},renderPerColumnMethods:{},afterRenderGridMethods:{}},additionalBeforeRenderGrid:function(parseSuccess,gridData,options){},additionalRenderPerRow:function(record,rowIndex,trObj,options){},additionalRenderPerColumn:function(record,rowIndex,colIndex,tdObj,trObj,options){},additionalAfterRenderGrid:function(parseSuccess,gridData,options){}},gridObjs:{},init:function(gridId,settings){var options={settings:$.extend(true,{},$.fn.bsgrid.defaults,settings),gridId:gridId,noPagingationId:gridId+"_no_pagination",pagingOutTabId:gridId+"_pt_outTab",pagingId:gridId+"_pt",sortName:"",sortOrder:"",otherParames:false,totalRows:0,totalPages:0,curPage:1,curPageRowsNum:0,startRow:0,endRow:0};options.settings.dataType=options.settings.dataType.toLowerCase();if(options.settings.pageSizeSelect){if($.inArray(options.settings.pageSize,options.settings.pageSizeForGrid)==-1){options.settings.pageSizeForGrid.push(options.settings.pageSize)}options.settings.pageSizeForGrid.sort(function(a,b){return a-b})}var gridObj={options:options,getPageCondition:function(curPage){return $.fn.bsgrid.getPageCondition(curPage,options)},page:function(curPage){$.fn.bsgrid.page(curPage,options)},getSelectedRow:function(){return $.fn.bsgrid.getSelectedRow(options)},selectRow:function(row){return $.fn.bsgrid.selectRow(row,options)},unSelectRow:function(){return $.fn.bsgrid.unSelectRow(options)},getRowRecord:function(rowObj){return $.fn.bsgrid.getRowRecord(rowObj)},getRecord:function(row){return $.fn.bsgrid.getRecord(row,options)},getRecordIndexValue:function(record,index){return $.fn.bsgrid.getRecordIndexValue(record,index,options)},getColumnValue:function(row,index){return $.fn.bsgrid.getColumnValue(row,index,options)},sort:function(obj){$.fn.bsgrid.sort(obj,options)},getGridHeaderObject:function(){return $.fn.bsgrid.getGridHeaderObject(options)},getColumnAttr:function(colIndex,attrName){return $.fn.bsgrid.getColumnAttr(colIndex,attrName,options)},appendHeaderSort:function(){$.fn.bsgrid.appendHeaderSort(options)},setGridBlankBody:function(){$.fn.bsgrid.setGridBlankBody(options)},createPagingOutTab:function(){$.fn.bsgrid.createPagingOutTab(options)},clearGridBodyData:function(){$.fn.bsgrid.clearGridBodyData(options)},getCurPage:function(){return $.fn.bsgrid.getCurPage(options)},refreshPage:function(){$.fn.bsgrid.refreshPage(options)},firstPage:function(){$.fn.bsgrid.firstPage(options)},prevPage:function(){$.fn.bsgrid.prevPage(options)},nextPage:function(){$.fn.bsgrid.nextPage(options)},lastPage:function(){$.fn.bsgrid.lastPage(options)},gotoPage:function(goPage){$.fn.bsgrid.gotoPage(options,goPage)},initPaging:function(){return $.fn.bsgrid.initPaging(options)},setPagingValues:function(){$.fn.bsgrid.setPagingValues(options)}};$.fn.bsgrid.gridObjs[gridId]=gridObj;if(options.settings.pageAll||options.settings.pageSize<1){options.settings.pageAll=true;options.settings.pageSize=0}gridObj.appendHeaderSort();gridObj.createPagingOutTab();if(!options.settings.pageAll){gridObj.pagingObj=gridObj.initPaging()}if(options.settings.isProcessLockScreen){$.fn.bsgrid.addLockScreen(options)}if(options.settings.autoLoad){setTimeout(function(){gridObj.page(1)},10)}else{gridObj.setGridBlankBody()}for(var key in options.settings.extend.initGridMethods){options.settings.extend.initGridMethods[key](gridId,options)}return gridObj},getGridObj:function(gridId){var obj=$.fn.bsgrid.gridObjs[gridId];return obj?obj:null},parseData:{success:function(type,gridData){if(type=="json"){return $.fn.bsgrid.parseJsonData.success(gridData)}else{if(type=="xml"){return $.fn.bsgrid.parseXmlData.success(gridData)}}return false},totalRows:function(type,gridData){if(type=="json"){return $.fn.bsgrid.parseJsonData.totalRows(gridData)}else{if(type=="xml"){return $.fn.bsgrid.parseXmlData.totalRows(gridData)}}return false},curPage:function(type,gridData){if(type=="json"){return $.fn.bsgrid.parseJsonData.curPage(gridData)}else{if(type=="xml"){return $.fn.bsgrid.parseXmlData.curPage(gridData)}}return false},data:function(type,gridData){if(type=="json"){return $.fn.bsgrid.parseJsonData.data(gridData)}else{if(type=="xml"){return $.fn.bsgrid.parseXmlData.data(gridData)}}return false},getRecord:function(type,data,row){if(type=="json"){return $.fn.bsgrid.parseJsonData.getRecord(data,row)}else{if(type=="xml"){return $.fn.bsgrid.parseXmlData.getRecord(data,row)}}return false},getColumnValue:function(type,record,index){if(type=="json"){return $.fn.bsgrid.parseJsonData.getColumnValue(record,index)}else{if(type=="xml"){return $.fn.bsgrid.parseXmlData.getColumnValue(record,index)}}return false}},parseJsonData:{success:function(json){return json.success},totalRows:function(json){return json.totalRows},curPage:function(json){return json.curPage},data:function(json){return json.data},getRecord:function(data,row){return data[row]},getColumnValue:function(record,index){return $.trim(record[index])}},parseXmlData:{success:function(xml){return $.trim($(xml).find("gridData success").text())=="true"},totalRows:function(xml){return parseInt($(xml).find("gridData totalRows").text())},curPage:function(xml){return parseInt($(xml).find("gridData curPage").text())},data:function(xml){return $(xml).find("gridData data row")},getRecord:function(data,row){return data.eq(row)},getColumnValue:function(record,index){return $.trim(record.find(index).text())}},getPageCondition:function(curPage,options){var params=new StringBuilder();if(options.otherParames==false){}else{if(options.otherParames instanceof Array){$.each(options.otherParames,function(i,objVal){params.append("&"+objVal.name+"="+objVal.value)})}else{for(var key in options.otherParames){params.append("&"+key+"="+options.otherParames[key])}}}var condition=params.length==0?"":params.toString().substring(1);condition+=(condition.length==0?"":"&")+options.settings.requestParamsName.pageSize+"="+options.settings.pageSize+"&"+options.settings.requestParamsName.curPage+"="+curPage+"&"+options.settings.requestParamsName.sortName+"="+options.sortName+"&"+options.settings.requestParamsName.sortOrder+"="+options.sortOrder;return condition},page:function(curPage,options){if($.trim(curPage)==""||isNaN(curPage)){alert($.bsgridLanguage.needInteger);return}var dataType=options.settings.dataType;$.ajax({type:"post",url:options.settings.url,data:$.fn.bsgrid.getPageCondition(curPage,options),dataType:dataType,beforeSend:function(XMLHttpRequest){if(options.settings.isProcessLockScreen){$.fn.bsgrid.lockScreen(options)}options.settings.beforeSend(options,XMLHttpRequest)},complete:function(XMLHttpRequest,textStatus){options.settings.complete(options,XMLHttpRequest,textStatus);if(options.settings.isProcessLockScreen){$.fn.bsgrid.unlockScreen(options)}},success:function(gridData,textStatus){var parseSuccess=$.fn.bsgrid.parseData.success(dataType,gridData);for(var key in options.settings.extend.beforeRenderGridMethods){options.settings.extend.beforeRenderGridMethods[key](parseSuccess,gridData,options)}options.settings.additionalBeforeRenderGrid(parseSuccess,gridData,options);if(parseSuccess){var totalRows=parseInt($.fn.bsgrid.parseData.totalRows(dataType,gridData));curPage=parseInt($.fn.bsgrid.parseData.curPage(dataType,gridData));if(options.settings.pageAll){curPage=1;options.settings.pageSize=totalRows;$("#"+options.noPagingationId).html(totalRows)}var pageSize=options.settings.pageSize;var curPageRowsNum=(curPage*pageSize<totalRows)?pageSize:(totalRows-(curPage-1)*pageSize);var totalPages=parseInt(totalRows/pageSize);totalPages=parseInt((totalRows%pageSize==0)?totalPages:totalPages+1);var startRow=(curPage-1)*pageSize+1;var endRow=(curPage-1)*pageSize+curPageRowsNum;startRow=curPageRowsNum<=0?0:startRow;endRow=curPageRowsNum<=0?0:endRow;options.totalRows=totalRows;options.totalPages=totalPages;options.curPage=curPage;options.curPageRowsNum=curPageRowsNum;options.startRow=startRow;options.endRow=endRow;if(!options.settings.pageAll){$.fn.bsgrid.setPagingValues(options)}if(options.settings.displayPagingToolbarOnlyMultiPages&&totalPages<=1){$("#"+options.pagingId).hide();$("#"+options.pagingOutTabId).hide()}else{$("#"+options.pagingOutTabId).show();$("#"+options.pagingId).show()}$.fn.bsgrid.setGridBlankBody(options);if(curPageRowsNum==0){return}var headerTh=$.fn.bsgrid.getGridHeaderObject(options);var data=$.fn.bsgrid.parseData.data(dataType,gridData);var dataLen=data.length;$.fn.bsgrid.addRowsClickEvent(options);$("#"+options.gridId+" tr:not(:first)").each(function(i){var trObj=$(this);var record=null;if(i<curPageRowsNum){record=$.fn.bsgrid.parseData.getRecord(dataType,data,dataLen!=totalRows?i:startRow+i-1)}$.fn.bsgrid.storeRowData(i,record,options);for(var key in options.settings.extend.renderPerRowMethods){options.settings.extend.renderPerRowMethods[key](record,i,trObj,options)}options.settings.additionalRenderPerRow(record,i,trObj,options);$(this).find("td").each(function(j){var index=$.trim(headerTh.eq(j).attr(options.settings.colsProperties.indexAttr));var render=$.trim(headerTh.eq(j).attr(options.settings.colsProperties.renderAttr));var tip=$.trim(headerTh.eq(j).attr(options.settings.colsProperties.tipAttr));var maxLen=$.trim(headerTh.eq(j).attr(options.settings.colsProperties.lengthAttr));maxLen=maxLen.length!=0?parseInt(maxLen):options.settings.colsProperties.maxLength;if(i<curPageRowsNum){if(render!=""){var render_method=eval(render);var render_html=render_method(record,i,j,options);$(this).html(render_html)}else{if(index!=""){var value=$.fn.bsgrid.parseData.getColumnValue(dataType,record,index);if(tip=="true"){$.fn.bsgrid.columnTip(this,value,record)}if(options.settings.longLengthAotoSubAndTip){$.fn.bsgrid.longLengthSubAndTip(this,value,maxLen,record)}else{$(this).html(value)}}}}else{$(this).html("&nbsp;")}for(var key in options.settings.extend.renderPerColumnMethods){var renderPerColumn_html=options.settings.extend.renderPerColumnMethods[key](record,i,j,$(this),trObj,options);if(renderPerColumn_html!=null&&renderPerColumn_html!=false){$(this).html(renderPerColumn_html)}}options.settings.additionalRenderPerColumn(record,i,j,$(this),trObj,options)})})}else{alert($.bsgridLanguage.errorForRequestData)}for(var key in options.settings.extend.afterRenderGridMethods){options.settings.extend.afterRenderGridMethods[key](parseSuccess,gridData,options)}options.settings.additionalAfterRenderGrid(parseSuccess,gridData,options)},error:function(XMLHttpRequest,textStatus,errorThrown){alert($.bsgridLanguage.errorForSendOrRequestData)}})},addRowsClickEvent:function(options){$("#"+options.gridId+" tr:not(:first):lt("+options.curPageRowsNum+")").click(function(){if($(this).hasClass("selected")){$(this).removeClass("selected")}else{$.fn.bsgrid.unSelectRow(options);$(this).addClass("selected")}})},getSelectedRow:function(options){return $("#"+options.gridId+" tr.selected")},selectRow:function(row,options){$.fn.bsgrid.unSelectRow(options);$("#"+options.gridId+" tr:eq("+(row+1)+")").addClass("selected")},unSelectRow:function(options){$.fn.bsgrid.getSelectedRow(options).removeClass("selected")},getRowRecord:function(rowObj){return rowObj.data("record")},storeRowData:function(row,record,options){$("#"+options.gridId+" tr:eq("+(row+1)+")").data("record",record)},getRecord:function(row,options){var record=$("#"+options.gridId+" tr:eq("+(row+1)+")").data("record");return record==undefined?null:record},getRecordIndexValue:function(record,index,options){if(record==null){return""}else{return $.fn.bsgrid.parseData.getColumnValue(options.settings.dataType,record,index)}},getColumnValue:function(row,index,options){var record=$.fn.bsgrid.getRecord(row,options);return $.fn.bsgrid.getRecordIndexValue(record,index,options)},sort:function(obj,options){var aObj=$(obj).find("a");var field=$(aObj).attr("sortName");$.fn.bsgrid.getGridHeaderObject(options).each(function(){if($.trim($(this).attr(options.settings.colsProperties.sortAttr)).length!=0){$(this).find("a").attr("class","sort sort-view")}});if(options.sortName==field){if(options.sortOrder=="asc"){options.sortOrder="desc";$(aObj).attr("class","sort sort-desc")}else{options.sortOrder="asc";$(aObj).attr("class","sort sort-asc")}}else{options.sortName=field;options.sortOrder="desc";$(aObj).attr("class","sort sort-desc")}$.fn.bsgrid.refreshPage(options)},getGridHeaderObject:function(options){return $("#"+options.gridId+" tr").first().find("th")},getColumnAttr:function(colIndex,attrName,options){return $.trim($.fn.bsgrid.getGridHeaderObject(options).eq(colIndex).attr(attrName))},appendHeaderSort:function(options){$.fn.bsgrid.getGridHeaderObject(options).each(function(){var sortAttr=options.settings.colsProperties.sortAttr;var sortInfo=$.trim($(this).attr(sortAttr));if(sortInfo.length!=0){var sortInfoArray=sortInfo.split(",");var sortName=sortInfoArray[0];var sortOrder=sortInfoArray.length>1?sortInfoArray[1]:"";var sortHtml='<a href="#" sortName="'+sortName+'" class="sort ';if(sortOrder!=""&&(sortOrder=="desc"||sortOrder=="asc")){options.sortName=sortName;options.sortOrder=sortOrder;sortHtml+="sort-"+sortOrder}else{sortHtml+="sort-view"}sortHtml+='">&nbsp;&nbsp;&nbsp;</a>';$(this).append(sortHtml)}});$("#"+options.gridId+" th .sort").each(function(){$(this).click(function(){$.fn.bsgrid.sort($(this).parent("th"),options)})})},setGridBlankBody:function(options){$("#"+options.gridId+" tr:not(:first)").remove();var header=$.fn.bsgrid.getGridHeaderObject(options);var rowSb="";if(options.settings.pageSize>0){var alignAttr=options.settings.colsProperties.alignAttr;var hiddenAttr=options.settings.colsProperties.hiddenAttr;var trSb=new StringBuilder();trSb.append("<tr>");for(var hi=0;hi<header.length;hi++){trSb.append("<td");var align=$.trim(header.eq(hi).attr(alignAttr));align=align==""?options.settings.colsProperties.align:align;trSb.append(' style="text-align: '+align+";");var hidden=$.trim(header.eq(hi).attr(hiddenAttr));if(hidden=="true"){header.eq(hi).css("display","none");trSb.append(" display: none;")}trSb.append('"');trSb.append("></td>")}trSb.append("</tr>");rowSb=trSb.toString()}var rowsSb=new StringBuilder();var curPageRowsNum=options.settings.pageSize;if(!options.settings.displayBlankRows){curPageRowsNum=options.endRow-options.startRow+1;curPageRowsNum=options.endRow>0?curPageRowsNum:0}if(curPageRowsNum==0){rowsSb.append('<tr><td colspan="'+header.length+'">'+$.bsgridLanguage.noDataToDisplay+"</td></tr>")}else{for(var pi=0;pi<curPageRowsNum;pi++){rowsSb.append(rowSb)}}$("#"+options.gridId).append(rowsSb.toString());if(curPageRowsNum!=0){if(options.settings.stripeRows){$("#"+options.gridId+" tr:even").addClass("even_index_row")}}},createPagingOutTab:function(options){var pagingOutTabSb=new StringBuilder();pagingOutTabSb.append('<table id="'+options.pagingOutTabId+'" class="bsgridPagingOutTab" style="display: none;"><tr><td align="'+options.settings.pagingToolbarAlign+'">');if(options.settings.pageAll){pagingOutTabSb.append($.bsgridLanguage.noPagingation(options.noPagingationId)+"&nbsp;&nbsp;&nbsp;")}pagingOutTabSb.append("</td></tr></table>");$("#"+options.gridId).after(pagingOutTabSb.toString())},clearGridBodyData:function(options){$("#"+options.gridId+" tr:not(:first)").each(function(){$(this).find("td").each(function(){$(this).html("&nbsp;")})})},addLockScreen:function(options){if($(".bsgrid.lockscreen").length==0){var lockScreenHtml=new StringBuilder();lockScreenHtml.append('<div class="bsgrid lockscreen" times="0">');lockScreenHtml.append("</div>");lockScreenHtml.append('<div class="bsgrid loading_div">');lockScreenHtml.append('<table><tr><td><center><div class="bsgrid loading"><span>&nbsp;&emsp;</span>&nbsp;'+$.bsgridLanguage.loadingDataMessage+"&emsp;<center></div></td></tr></table>");lockScreenHtml.append("</div>");$("body").append(lockScreenHtml.toString())}},lockScreen:function(options){$(".bsgrid.lockscreen").attr("times",parseInt($(".bsgrid.lockscreen").attr("times"))+1);if($(".bsgrid.lockscreen").css("display")=="none"){$(".bsgrid.lockscreen").show();$(".bsgrid.loading_div").show()}},unlockScreen:function(options){$(".bsgrid.lockscreen").attr("times",parseInt($(".bsgrid.lockscreen").attr("times"))-1);if($(".bsgrid.lockscreen").attr("times")=="0"){setTimeout(function(){$(".bsgrid.lockscreen").hide();$(".bsgrid.loading_div").hide()},100)}},columnTip:function(obj,value,record){$(obj).attr("title",value)},longLengthSubAndTip:function(obj,value,maxLen,record){if(value.length>maxLen){$(obj).html(value.substring(0,maxLen-3)+"...");$.fn.bsgrid.columnTip(obj,value,record)}else{$(obj).html(value)}},getCurPage:function(options){return $.fn.bsgrid.getGridObj(options.gridId).pagingObj.getCurPage()},refreshPage:function(options){if(!options.settings.pageAll){$.fn.bsgrid.getGridObj(options.gridId).pagingObj.refreshPage()}else{$.fn.bsgrid.page(1,options)}},firstPage:function(options){$.fn.bsgrid.getGridObj(options.gridId).pagingObj.firstPage()},prevPage:function(options){$.fn.bsgrid.getGridObj(options.gridId).pagingObj.prevPage()},nextPage:function(options){$.fn.bsgrid.getGridObj(options.gridId).pagingObj.nextPage()},lastPage:function(options){$.fn.bsgrid.getGridObj(options.gridId).pagingObj.lastPage()},gotoPage:function(options,goPage){$.fn.bsgrid.getGridObj(options.gridId).pagingObj.gotoPage(goPage)},initPaging:function(options){$("#"+options.pagingOutTabId+" td").attr("id",options.pagingId);return $.fn.bsgrid_paging.init(options.pagingId,{gridId:options.gridId,pageSize:options.settings.pageSize,pageSizeSelect:options.settings.pageSizeSelect,pageSizeForGrid:options.settings.pageSizeForGrid,pagingBtnClass:options.settings.pagingBtnClass})},setPagingValues:function(options){$.fn.bsgrid.getGridObj(options.gridId).pagingObj.setPagingValues(options.curPage,options.totalRows)}}})(jQuery);
(function(a){a.fn.bsgrid.defaults.colsProperties.editAttr="w_edit";a.fn.bsgrid.extendInit={};a.fn.bsgrid.extendInit.initForm=function(b,c){a.fn.bsgrid.getGridHeaderObject(c).each(function(d){var e=a.trim(a(this).attr(c.settings.colsProperties.editAttr));if(e=="checkbox"){a("#"+b+" tr:first th:eq("+d+") input[type=checkbox]").change(function(){if(a(this).attr("checked")){a("#"+b+" tr:not(:first)").each(function(){a(this).find("td:eq("+d+")>input[type=checkbox]").attr("checked",true)})}else{a("#"+b+" tr:not(:first)").each(function(){a(this).find("td:eq("+d+")>input[type=checkbox]").attr("checked",false)})}})}})};a.fn.bsgrid.defaults.extend.initGridMethods.initForm=a.fn.bsgrid.extendInit.initForm;a.fn.bsgrid.extendInit.initColumnMove=function(c,d){a("#"+d.gridId).css({"table-layout":"fixed"});var e=a.fn.bsgrid.getGridHeaderObject(d);var b=e.length;e.each(function(g){var h=this;a(h).mousedown(function(){f(h,g,b)});a(h).mousemove(function(){var q=a(h).offset().left;var n=0,o=0;if(g!=b-1){n=a(h).next();o=n.offset().left}var p=h;if(g!=b-1&&event.clientX-o>-10){p=n}if((g!=0&&event.clientX-q<10)||(g!=b-1&&event.clientX-o>-10)){a(h).css({cursor:"e-resize"});if(a.trim(a(h).data("ex_mousedown"))!="mousedown"){return}var l=a(p).width();var m=l-event.clientX+a(p).offset().left;var k=a(p).prev().width();var i=k+event.clientX-a(p).offset().left;if(parseInt(m)>19&&parseInt(i)>19){a(p).width(m).prev().width(i)}}else{a(p).css({cursor:"default"});j(h,g,b)}});a(h).mouseup(function(){j(h,g,b)});a(h).mouseout(function(){var i=a(h).offset();if(i.top>event.clientY||i.top+a(h).height()<event.clientY){j(h,g,b)}});function f(m,l,k){if(l!=0){a(m).prev().data("ex_mousedown","mousedown")}a(m).data("ex_mousedown","mousedown");if(l!=k-1){a(m).next().data("ex_mousedown","mousedown")}}function j(m,l,k){if(l!=0){a(m).prev().data("ex_mousedown","")}a(m).data("ex_mousedown","");if(l!=k-1){a(m).next().data("ex_mousedown","")}}})};a.fn.bsgrid.defaults.extend.initGridMethods.initColumnMove=a.fn.bsgrid.extendInit.initColumnMove;a.fn.bsgrid.extendRender={};a.fn.bsgrid.extendRender.renderForm=function(d,g,j,c,f,k){if(g<k.curPageRowsNum){var b=a.fn.bsgrid.getGridObj(k.gridId);var e=b.getColumnAttr(j,k.settings.colsProperties.indexAttr);var i=b.getColumnAttr(j,k.settings.colsProperties.editAttr);var h=b.getColumnValue(g,e);if(i=="text"||i=="hidden"||i=="password"||i=="radio"||i=="checkbox"||i=="button"){return'<input type="'+i+'" value="'+h+'"/>'}else{if(i=="textarea"){return"<textarea>"+h+"</textarea>"}}}else{return false}};a.fn.bsgrid.defaults.extend.renderPerColumnMethods.renderForm=a.fn.bsgrid.extendRender.renderForm})(jQuery);
(function(a){a.bsgrid_export={defaults:{url:"",exportFileName:"export",colsProperties:{width:100,align:"center",exportAttr:"w_export",indexAttr:"w_index",widthAttr:"width",alignAttr:"w_align"},colWidthPercentmultiplier:14,requestParamsName:{exportFileName:"exportFileName",colNames:"dataNames",colIndexs:"dataIndexs",colWidths:"dataLengths",colAligns:"dataAligns"}},doExport:function(g,l,c){if(l==undefined){l={}}var b={};if(c==undefined){c={}}a.extend(true,b,a.bsgrid_export.defaults,c);var n="",f="",m="",h="";for(var e=0;e<g.length;e++){if(a.trim(g.eq(e).attr(b.colsProperties.exportAttr))!="false"){n=n+","+a.trim(g.eq(e).text());f=f+","+a.trim(g.eq(e).attr(b.colsProperties.indexAttr));var k=a.trim(g.eq(e).attr(b.colsProperties.widthAttr)).toLocaleLowerCase();var d=b.colsProperties.width;if(isNaN(k)){if(k.endWith("px")){d=parseInt(k.replace("px",""))}else{if(k.endWith("%")){k=k.replace("%","");if(!isNaN(k)){d=b.colWidthPercentmultiplier*parseInt(k)}}}}m=m+","+d;var j=a.trim(g.eq(e).attr(b.colsProperties.alignAttr));if(j==""){j=b.colsProperties.align}h=h+","+j}}document.location.href=b.url+(b.url.indexOf("?")<0?"?":"&")+b.requestParamsName.exportFileName+"="+encodeURIComponent(encodeURIComponent(b.exportFileName))+"&"+b.requestParamsName.colNames+"="+encodeURIComponent(encodeURIComponent(n.substring(1)))+"&"+b.requestParamsName.colIndexs+"="+f.substring(1)+"&"+b.requestParamsName.colWidths+"="+m.substring(1)+"&"+b.requestParamsName.colAligns+"="+h.substring(1)+(l.length==0?"":("&"+a.bsgrid.param(l,true)))}}})(jQuery);
(function(a){a.fn.bsgrid_form={defaults:{},formObjs:{},init:function(e,d){var c={settings:a.extend(true,{},a.fn.bsgrid_form.defaults,d),formId:e,jqueryObj:a("#"+e),formType:""};var b={options:c,addAssistShowFormTags:function(){a.fn.bsgrid_form.addAssistShowFormTags(c)},showForm:function(f){a.fn.bsgrid_form.showForm(c,f)},showOrHideRequireSpan:function(f){a.fn.bsgrid_form.showOrHideRequireSpan(c,f)},showOrHideAssistForms:function(f){a.fn.bsgrid_form.showOrHideAssistForms(c,f)},showOrHideTag:function(f){a.fn.bsgrid_form.showOrHideTag(c,f)}};a.fn.bsgrid_form.formObjs[e]=b;b.addAssistShowFormTags();return b},getFormObj:function(c){var b=a.fn.bsgrid_form.formObjs[c];return b?b:null},addAssistShowFormTags:function(b){a(".formInput select",b.jqueryObj).each(function(){a(this).before('<input type="text" style="display: none;" />');var d=a(this).get(0).attributes;for(var e=0;e<d.length;e++){var c=d[e].name;if(c.toLowerCase().endWith("able")&&a(this).attr(c)=="false"){a(this).prev("input").attr(c,"false")}}});a(".formInput textarea",b.jqueryObj).each(function(){a(this).before('<div class="assist" style="display: none;"></div>')})},showForm:function(b,c){b.formType=c;this.showOrHideRequireSpan(b,c);this.showOrHideAssistForms(b,c);this.showOrHideTag(b,c);if(c.startWith("view")){a(".formInput :input:not(:button,:submit,:reset)",b.jqueryObj).css({"border-width":"0"}).attr("readOnly","readOnly")}else{if(c.startWith("add")){a(".formInput :input:not(:button,:submit,:reset)",b.jqueryObj).css({border:"solid 1px #abadb3"}).removeAttr("readOnly")}else{if(c.startWith("edit")){a(".formInput :input:not(:button,:submit,:reset)",b.jqueryObj).css({border:"solid 1px #abadb3"}).removeAttr("readOnly");a(".formInput :input["+c+"Able=false]",b.jqueryObj).css({"border-width":"0"}).attr("readOnly","readOnly")}}}},showOrHideRequireSpan:function(b,c){if(c.startWith("view")){a(".formLabel span.require",b.jqueryObj).hide()}else{if(c.startWith("edit")){a(".formLabel:has(span.require) ~ .formInput:has(:input["+c+"Able=false])",b.jqueryObj).prev().find("span.require").hide()}else{a(".formLabel span.require",b.jqueryObj).show()}}},showOrHideAssistForms:function(b,c){a(".formInput select",b.jqueryObj).each(function(){var e=(c.startWith("view")||(c.startWith("edit")&&a(this).attr(c+"Able")=="false"))?"block":"none";a(this).prev("input").css("display",e).val(a(this).find("option:selected").text());var d=e=="block"?"none":"block";a(this).css("display",d)});a(".formInput textarea",b.jqueryObj).each(function(){var e=(c.startWith("view")||(c.startWith("edit")&&a(this).attr(c+"Able")=="false"))?"block":"none";a(this).prev("div").css("display",e).html(a(this).val());var d=e=="block"?"none":"block";a(this).css("display",d)})},showOrHideTag:function(b,c){a("*",b.jqueryObj).each(function(){var d=a.trim(a(this).attr("showType"));if(d!=""){if((c.startWith("view")||c.startWith("add")||c.startWith("edit"))&&(","+d+",").indexOf(","+c+",")>-1){a(this).show()}else{a(this).hide()}}})}}})(jQuery);

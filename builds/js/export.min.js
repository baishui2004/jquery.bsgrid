/**
* jQuery.bsgrid v1.35 by @Baishui2004
* Copyright 2014 Apache v2 License
* https://github.com/baishui2004/jquery.bsgrid
*/
(function(a){a.bsgrid_export={defaults:{url:"",exportFileName:"export",colsProperties:{width:100,align:"center",exportAttr:"w_export",indexAttr:"w_index",widthAttr:"width",alignAttr:"w_align"},colWidthPercentmultiplier:14,requestParamsName:{exportFileName:"exportFileName",colNames:"dataNames",colIndexs:"dataIndexs",colWidths:"dataLengths",colAligns:"dataAligns"}},doExport:function(g,l,c){if(l==undefined){l={}}var b={};if(c==undefined){c={}}a.extend(true,b,a.bsgrid_export.defaults,c);var n="",f="",m="",h="";for(var e=0;e<g.length;e++){if(a.trim(g.eq(e).attr(b.colsProperties.exportAttr))!="false"){n=n+","+a.trim(g.eq(e).text());f=f+","+a.trim(g.eq(e).attr(b.colsProperties.indexAttr));var k=a.trim(g.eq(e).attr(b.colsProperties.widthAttr)).toLocaleLowerCase();var d=b.colsProperties.width;if(isNaN(k)){if(k.endWith("px")){d=parseInt(k.replace("px",""))}else{if(k.endWith("%")){k=k.replace("%","");if(!isNaN(k)){d=b.colWidthPercentmultiplier*parseInt(k)}}}}m=m+","+d;var j=a.trim(g.eq(e).attr(b.colsProperties.alignAttr));if(j==""){j=b.colsProperties.align}h=h+","+j}}document.location.href=b.url+(b.url.indexOf("?")<0?"?":"&")+b.requestParamsName.exportFileName+"="+encodeURIComponent(encodeURIComponent(b.exportFileName))+"&"+b.requestParamsName.colNames+"="+encodeURIComponent(encodeURIComponent(n.substring(1)))+"&"+b.requestParamsName.colIndexs+"="+f.substring(1)+"&"+b.requestParamsName.colWidths+"="+m.substring(1)+"&"+b.requestParamsName.colAligns+"="+h.substring(1)+(l.length==0?"":("&"+a.bsgrid.param(l,true)))}}})(jQuery);
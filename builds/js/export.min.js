/**
* jQuery.bsgrid v1.39-pre by @Baishui2004
* Copyright 2014 Apache v2 License
* https://github.com/baishui2004/jquery.bsgrid
*/
(function(a){a.bsgrid_export={defaults:{url:"",exportFileName:"export",colsProperties:{width:100,align:"center",exportAttr:"w_export",indexAttr:"w_index",widthAttr:"width",alignAttr:"w_align"},colWidthPercentmultiplier:14,requestParamsName:{exportFileName:"exportFileName",colNames:"dataNames",colIndexes:"dataIndexes",colWidths:"dataLengths",colAligns:"dataAligns"}},doExport:function(h,o,d){if(o==undefined){o={}}var c={};if(d==undefined){d={}}a.extend(true,c,a.bsgrid_export.defaults,d);var n="",g="",m="",j="";for(var f=0;f<h.length;f++){if(a.trim(h.eq(f).attr(c.colsProperties.exportAttr))!="false"){n=n+","+a.trim(h.eq(f).text());g=g+","+a.trim(h.eq(f).attr(c.colsProperties.indexAttr));var l=a.trim(h.eq(f).attr(c.colsProperties.widthAttr)).toLocaleLowerCase();var e=c.colsProperties.width;if(isNaN(l)){if(l.endWith("px")){e=parseInt(l.replace("px",""))}else{if(l.endWith("%")){l=l.replace("%","");if(!isNaN(l)){e=c.colWidthPercentmultiplier*parseInt(l)}}}}m=m+","+e;var k=a.trim(h.eq(f).attr(c.colsProperties.alignAttr));if(k==""){k=c.colsProperties.align}j=j+","+k}}var b;if((typeof o).toLowerCase()=="string"||o instanceof String){b=(o.startWith("&")?o.substring(1):o)}else{b=a.bsgrid.param(o,true)}document.location.href=c.url+(c.url.indexOf("?")<0?"?":"&")+c.requestParamsName.exportFileName+"="+encodeURIComponent(encodeURIComponent(c.exportFileName))+"&"+c.requestParamsName.colNames+"="+encodeURIComponent(encodeURIComponent(n.substring(1)))+"&"+c.requestParamsName.colIndexes+"="+g.substring(1)+"&"+c.requestParamsName.colWidths+"="+m.substring(1)+"&"+c.requestParamsName.colAligns+"="+j.substring(1)+(b.length==0?"":("&"+b))}}})(jQuery);